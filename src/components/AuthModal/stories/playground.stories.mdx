import { Meta, Story } from '@storybook/addon-docs';
import { useState } from 'react';
import classNames from 'classnames';
import AuthModal from 'Components/AuthModal/AuthModal';
import styles from './stories.module.scss';

<Meta
    title="Components/AuthModal"
    component={AuthModal}
    argTypes={{
        onClose: {
            table: { disable: true },
        },
        selectedView: {
            table: { disable: true },
        },
    }}
/>

# Playground

This component receives no props so there are no controls. Navigate to
the different views. Services are mocked to show errors when trying
to sign in, register or reset a password.

export function Template() {
    const [isAuthOpen, setIsAuthOpen] = useState(false);
    const handleClose = () => setIsAuthOpen(false);
    const handleOpen = () => setIsAuthOpen(true);
    const buttonClasses = classNames({
        [styles.btn]: true,
        [styles.text]: true,
    });
    return (
        <div style={{ height: '500px' }}>
            <button
                type="button"
                onClick={handleOpen}
                className={buttonClasses}
            >
                Click to open AuthModal
            </button>
            {isAuthOpen && (
                <AuthModal
                    selectedView={AuthModal.views.SIGN_IN}
                    onClose={handleClose}
                />
            )}
        </div>
    );
}
const beforeTests = async (container) => {
    await container.$eval('button', (element) => element.click());
};

<Story
    name="Playground"
    parameters={{
        custom: {
            beforeA11y: beforeTests,
            beforeScreenshot: beforeTests,
        },
    }}
>
    {Template.bind({})}
</Story>
