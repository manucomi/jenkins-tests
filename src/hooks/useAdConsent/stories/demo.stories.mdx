<!-- eslint-disable no-unused-vars -->

import { Meta, Story } from '@storybook/addon-docs';
import { useState } from 'react';
import { action } from '@storybook/addon-actions';
import useAdConsent from '../useAdConsent';
import AdSlot from '../../../components/AdSlot/AdSlot';
import AdConsentModal from '../../../../story-helpers/AdConsentModal/AdConsentModal';

<Meta title="Hooks/useAdConsent/Demo" />

# Demo

export const loadScript = () => {
    const newtag = document.createElement('script');
    newtag.src = 'https://securepubads.g.doubleclick.net/tag/js/gpt.js';
    newtag.async = true;
    document.head.appendChild(newtag);
    window.googletag = newtag;
};

export function DemoApp() {
    const [showModal, setShowModal] = useState(true);
    const [adConsent, setAdConsent] = useState(null);
    loadScript();
    const handleAccept = () => {
        setAdConsent(true);
        setShowModal(false);
    };
    const handleReject = () => {
        setAdConsent(false);
        setShowModal(false);
    };
    return (
        <>
            The following ad is conditionally rendered by the output of the
            <code> useAdConsent</code> hook.
            <hr />
            <AdConsentModal
                show={showModal}
                onAccept={handleAccept}
                onReject={handleReject}
            />
            {adConsent && (
                <AdSlot
                    targets={{ position: '11' }}
                    size={[[230, 230]]}
                    path="/34363400/TEST_Single-PartnerCenter_230x230"
                    onSlotRender={action('adslot loaded')}
                />
            )}
        </>
    );
}

export function Template() {
    return <DemoApp />;
}

<Story name="Demo">{Template.bind({})}</Story>
